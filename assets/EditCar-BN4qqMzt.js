import{_ as j,u as L,q as X,i as G,r as d,c as i,a as e,k as u,v as h,n as c,g as r,F as H,j as J,l as V,m as M,s as C,o as n,p as W,d as Y}from"./index-C3LY4VYU.js";import{E as O}from"./Emitter-BG7KJySb.js";import{d as N}from"./databaseLocal-BRjNRnEM.js";const s=m=>(W("data-v-eb2fd585"),m=m(),Y(),m),ee={class:"page int"},ae={class:"form-control"},oe=s(()=>e("label",{for:"placa",class:"label-required"},"Placa:",-1)),te={key:0,class:"error-message"},le={key:1,class:"error-message"},se={class:"form-control"},ie=s(()=>e("label",{for:"modelo",class:"label-required"},"Modelo:",-1)),ne={key:0,class:"error-message"},de={id:"modelos"},ue=["value"],re={class:"form-group",id:"segmentacao"},ce=s(()=>e("legend",null,"Segmentação",-1)),me={class:"field"},ve=s(()=>e("label",{for:"consumidor",class:"label-radio consumidor"},"Consumidor",-1)),pe={class:"field"},_e=s(()=>e("label",{for:"revenda",class:"label-radio revenda"},"Revenda",-1)),fe={key:0,class:"error-message"},be={class:"form-group",id:"tipo"},ge=s(()=>e("legend",null,"Tipo de serviço",-1)),he={class:"field"},Ve=s(()=>e("label",{for:"tp",class:"label-radio tp"},"Troca de peça",-1)),ye={class:"field"},xe=s(()=>e("label",{for:"sm",class:"label-radio sm"},"Serviço mecânico",-1)),Pe={key:0,class:"error-message"},qe={class:"form-control"},Ee=s(()=>e("label",{for:"qtdPecas",class:"label-required"},"Quantidade de Peças:",-1)),Ie={key:0,class:"error-message"},Te={id:"detailsObservacao"},we=s(()=>e("summary",null,"Alguma observação sobre o veículo?",-1)),Ce={class:"form-control"},Ne=s(()=>e("label",{for:"observacao",class:"label"},"Observação:",-1)),Be=s(()=>e("i",{class:"ri-delete-bin-6-line"},null,-1)),Se=s(()=>e("i",{class:"ri-save-3-fill"},null,-1)),ke={__name:"EditCar",setup(m){const{push:B}=L(),{params:y}=X();G(()=>{O.emit("add-car"),setTimeout(()=>{O.emit("name-route","editar etapa troca de peças")},100),z(y.id)});const U=d(["Argo","Onix","Onix Plus","KA","Mobi"]),a=d({placa:null,modelo:null,segmentacao:null,tipo:null,qtdPecas:null,observacao:""}),v=d(!0),p=d(!0),_=d(!0),f=d(!0),b=d(!0),g=d(!0);function x(){if(!a.value.placa){document.getElementById("placa").scrollIntoView({behavior:"smooth"}),p.value=!1;return}p.value=!0;const l=a==null?void 0:a.value.placa.trim(),o=/^[A-Z]{3}\d[A-Z]\d{2}$/,t=/^[A-Z]{3}-\d{4}$/;v.value=o.test(l)||t.test(l),v.value||document.getElementById("placa").scrollIntoView({behavior:"smooth"})}let P,q,E,I;const D=()=>{P&&clearTimeout(P),P=setTimeout(()=>{x()},600)},K=()=>{q&&clearTimeout(q),q=setTimeout(()=>{S()},600)},R=()=>{E&&clearTimeout(E),E=setTimeout(()=>{k()},600)},Q=()=>{I&&clearTimeout(I),I=setTimeout(()=>{},600)};function S(){const l=a.value.modelo;_.value=!0,(!l||l=="")&&(_.value=!1,document.getElementById("modelo").scrollIntoView({behavior:"smooth"}))}function T(){if(!a.value.segmentacao){document.getElementById("segmentacao").scrollIntoView({behavior:"smooth"}),f.value=!1;return}f.value=!0}function w(){if(!a.value.tipo){document.getElementById("tipo").scrollIntoView({behavior:"smooth"}),b.value=!1;return}b.value=!0}function k(){const l=a.value.qtdPecas;g.value=!0,(!l||l=="")&&(g.value=!1,document.getElementById("qtdPecas").scrollIntoView({behavior:"smooth"}))}const Z=()=>{x(),S(),T(),w(),k()},A=()=>{a.value={placa:null,modelo:null,segmentacao:null,tipo:null,qtdPecas:null,observacao:""}},z=async l=>{if(!l)return;const o=await N.vehicle.get(Number(l));a.value=o,a.value.observacao&&(document.querySelector("#detailsObservacao").open=!0)},F=async()=>{if(!a.value.placa||!a.value.modelo||!a.value.segmentacao||!a.value.tipo||!a.value.qtdPecas){Z();return}const l=new Date().toISOString();if(a.value.updateAt=l,await N.vehicle.update(Number(y.id),{...a.value})){C("Editado com sucesso!","success"),A(),B("/cars/");return}C("Error ao editar!","error")},$=async()=>{confirm("Tem certeza que quer deletar esse registro?")&&(await N.vehicle.delete(Number(y.id)),A(),B("/cars/"),C("deletado com sucesso!","alert"))};return(l,o)=>(n(),i("main",ee,[e("div",ae,[oe,u(e("input",{type:"text",tabindex:"1",class:c({input:!0,invalid:!v.value||!p.value}),"onUpdate:modelValue":o[0]||(o[0]=t=>a.value.placa=t),id:"placa",maxlength:"7",onKeyup:D,placeholder:"placa do veículo. EX: ABC1D123 ou ABC-1234",onBlur:x},null,34),[[h,a.value.placa]]),v.value?r("",!0):(n(),i("p",te,"Placa inválida!")),p.value?r("",!0):(n(),i("p",le,"Placa é obrigatória!"))]),e("div",se,[ie,u(e("input",{type:"text",list:"modelos",tabindex:"2",class:c({input:!0,invalid:!_.value}),"onUpdate:modelValue":o[1]||(o[1]=t=>a.value.modelo=t),id:"modelo",onKeyup:K,placeholder:"modelo do veículo"},null,34),[[h,a.value.modelo]]),_.value?r("",!0):(n(),i("p",ne,"ops, esqueceu de digitar o modelo!"))]),e("datalist",de,[(n(!0),i(H,null,J(U.value,t=>(n(),i("option",{value:t},null,8,ue))),256))]),e("div",re,[e("fieldset",{class:c({fieldsetNotSelected:!f.value})},[ce,e("div",me,[ve,u(e("input",{type:"radio",onChange:T,tabindex:"3",id:"consumidor",name:"segmentacao",class:"input-radio","onUpdate:modelValue":o[2]||(o[2]=t=>a.value.segmentacao=t),value:"consumidor"},null,544),[[V,a.value.segmentacao]])]),e("div",pe,[_e,u(e("input",{type:"radio",onChange:T,tabindex:"4",id:"revenda",name:"segmentacao",class:"input-radio","onUpdate:modelValue":o[3]||(o[3]=t=>a.value.segmentacao=t),value:"revenda"},null,544),[[V,a.value.segmentacao]])]),f.value?r("",!0):(n(),i("p",fe,"selecione!"))],2)]),e("div",be,[e("fieldset",{class:c({fieldsetNotSelected:!b.value})},[ge,e("div",he,[Ve,u(e("input",{type:"radio",onChange:w,tabindex:"5",id:"tp",name:"tipo",class:"input-radio","onUpdate:modelValue":o[4]||(o[4]=t=>a.value.tipo=t),value:"TP"},null,544),[[V,a.value.tipo]])]),e("div",ye,[xe,u(e("input",{type:"radio",onChange:w,tabindex:"6",id:"sm",name:"tipo",class:"input-radio","onUpdate:modelValue":o[5]||(o[5]=t=>a.value.tipo=t),value:"SM"},null,544),[[V,a.value.tipo]])]),b.value?r("",!0):(n(),i("p",Pe,"selecione!"))],2)]),e("div",qe,[Ee,u(e("input",{type:"tel",min:"1",max:"2",maxlength:"2",tabindex:"7",class:c({input:!0,invalid:!g.value}),"onUpdate:modelValue":o[6]||(o[6]=t=>a.value.qtdPecas=t),id:"qtdPecas",placeholder:"Ex: 3",onKeyup:R},null,34),[[h,a.value.qtdPecas,void 0,{number:!0}]]),g.value?r("",!0):(n(),i("p",Ie,"ops, esqueceu de digitar a quantidade de peças!"))]),e("details",Te,[we,e("div",Ce,[Ne,u(e("textarea",{class:"textarea",onKeyup:Q,"onUpdate:modelValue":o[7]||(o[7]=t=>a.value.observacao=t),id:"observacao",placeholder:"Ex: veículo com amassado na porta d/d."},null,544),[[h,a.value.observacao]])])]),e("div",{class:"form-group"},[e("button",{class:"btn danger",onClick:$,tabindex:"8"},[M(" deletar "),Be]),e("button",{class:"btn alert",onClick:F,tabindex:"8"},[M(" Registrar "),Se])])]))}},Ue=j(ke,[["__scopeId","data-v-eb2fd585"]]);export{Ue as default};
